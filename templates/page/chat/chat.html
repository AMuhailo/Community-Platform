{% extends "base.html" %}

{% block content %}
<div class="container-md">
        <div class="chat-container mx-auto">
            <div class="chat-header">
                Chat 
                <span class='chat-online'>3 online</span>
            </div>
            <div class="chat-messages" id="chat_messages">
                {% for message in messages reversed %}
                    {% include "page/chat/chat_message.html" %}
                {% endfor %}
            </div>
            
            <div class="chat-footer">
                <form class="w-100" 
                    hx-ext="ws"
                    ws-connect="/ws/chatroom/public-chat"
                    ws-send
                    _="on htmx:wsAfterSend reset() me">
                        {% csrf_token %}
                        {% for field in form %}
                            {{ field }}
                        {% endfor %}
                    <button class="submit">Send</button>
                </form>
            </div>
        </div>
    </div>
{% endblock content %}

{% block js %}

        let chatMessages = document.getElementById("chat_messages");

        function scrollToBottom() {
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        scrollToBottom();
{% endblock js %}
